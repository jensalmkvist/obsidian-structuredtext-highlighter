/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => StructuredTextSyntaxHighlighterPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian2 = require("obsidian");

// loadPrismWithST.ts
var import_obsidian = require("obsidian");
var applyPrismST = (Prism) => {
  const controlKeywordGroups = {
    ifStatementKeywords: ["IF", "ELSIF", "ELSE", "THEN", "END_IF"],
    caseStatementKeywords: ["CASE", "OF", "END_CASE"],
    forStateMentKeywords: ["FOR", "TO", "BY", "DO", "END_FOR"],
    whileStatementKeywords: ["WHILE", "DO", "END_WHILE"],
    repeatStatmentKeywords: ["REPEAT", "UNTIL", "END_REPEAT"],
    continueKeyword: ["CONTINUE"],
    exitStatementKeywords: ["EXIT"],
    returnStatementKeywords: ["RETURN"]
  };
  const typedKeywordGroups = {
    intKeywords: ["USINT", "SINT", "UINT", "INT", "UDINT", "DINT", "ULINT", "LINTT"],
    floatKeywords: ["REAL", "LREAL"],
    boolKeywords: ["BOOL"],
    stringKeywords: ["STRING", "WSTRING"],
    binKeywords: ["BYTE", "WORD", "DWORD", "LWORD"],
    timeKeywords: ["TIME", "LTIME"]
  };
  const declarationKeywords = {
    variables: ["VAR", "VAR_INPUT", "VAR_OUTPUT", "VAR_IN_OUT", "VAR_TEMP", "VAR_CONSTANT", "END_VAR"],
    types: ["TYPE", "END_TYPE", "STRUCT", "END_STRUCT"],
    functions: ["FUNCTION", "END_FUNCTION", "FUNCTION_BLOCK", "END_FUNCTION_BLOCK"]
  };
  const allKeywords = [
    ...Object.values(controlKeywordGroups).flat(),
    ...Object.values(typedKeywordGroups).flat(),
    ...Object.values(declarationKeywords).flat()
  ];
  const keywordRegex = new RegExp(`\\b(${allKeywords.join("|")})\\b`);
  Prism.languages.structuredtext = Prism.languages.extend("clike", {
    keyword: keywordRegex,
    boolean: /\b(TRUE|FALSE)\b/,
    operator: /\b(AND|OR|NOT|XOR)\b|:=|<>|<=|>=|<|>/,
    number: /\b\d+(\.\d+)?\b/,
    punctuation: /[();,]/,
    identifier: /\b[A-Za-z_][A-Za-z0-9_]*\b/
  });
  Prism.hooks.add("wrap", (env) => {
    if (env.type === "entity") {
      env.attributes["title"] = env.content.replace(/&amp;/, "&");
    }
  });
};
var loadPrismWithST = async () => {
  try {
    const Prism = await (0, import_obsidian.loadPrism)();
    applyPrismST(Prism);
    return Prism;
  } catch (error) {
    console.error("Failed to load Prism:", error);
    throw error;
  }
};
var loadPrismWithST_default = loadPrismWithST;

// structuredtextHighlighter.ts
var import_view = require("@codemirror/view");
var import_state = require("@codemirror/state");
var StructuredTextHighlight = class {
  constructor(view) {
    this.decorations = import_view.Decoration.none;
    this.loadPrism().then(() => {
      this.decorations = this.buildDecorations(view);
      view.update([]);
    });
  }
  update(update) {
    if (update.viewportChanged || update.docChanged) {
      this.decorations = this.buildDecorations(update.view);
    }
  }
  async loadPrism() {
    this.prism = await loadPrismWithST_default();
  }
  buildDecorations(view) {
    const builder = new import_state.RangeSetBuilder();
    if (!this.prism) {
      return import_view.Decoration.none;
    }
    const text = view.state.doc.toString();
    const regex = /```structuredtext(?:[\s\S]*?)([\s\S]*?)\n```/gi;
    let match;
    while ((match = regex.exec(text)) !== null) {
      const codeBlock = match[1];
      const highlighted = this.prism.highlight(codeBlock, this.prism.languages.structuredtext, "structuredtext");
      const blockStart = match.index + match[0].indexOf(match[1]);
      this.applyHighlighting(highlighted, blockStart, builder);
    }
    return builder.finish();
  }
  applyHighlighting(highlighted, blockStart, builder) {
    const parser = new DOMParser();
    const doc = parser.parseFromString(highlighted, "text/html");
    const tempEl = doc.body;
    let currentIndex = blockStart;
    const ranges = [];
    const traverse = (node) => {
      if (node.nodeType === Node.TEXT_NODE) {
        const text = node.textContent || "";
        currentIndex += text.length;
      } else if (node.nodeType === Node.ELEMENT_NODE) {
        const element = node;
        const className = element.className;
        const start = currentIndex;
        element.childNodes.forEach((child) => traverse(child));
        const end = currentIndex;
        if (className) {
          ranges.push({ start, end, className });
        }
      }
    };
    tempEl.childNodes.forEach((child) => traverse(child));
    ranges.sort((a, b) => a.start - b.start);
    for (const range of ranges) {
      builder.add(range.start, range.end, import_view.Decoration.mark({ class: range.className }));
    }
  }
};

// main.ts
var import_view2 = require("@codemirror/view");
console.log("StructuredText plugin file loaded");
var StructuredTextSyntaxHighlighterPlugin = class extends import_obsidian2.Plugin {
  async onload() {
    console.log("Reached onload");
    try {
      console.log("Loading Structured Text Highlighter Plugin");
      this.obsidianPrism = await loadPrismWithST_default();
      console.log("prism loaded");
      this.registerMarkdownPostProcessor((el, ctx) => {
        el.querySelectorAll("pre > code.language-structuredtext").forEach((block) => {
          this.obsidianPrism.highlightElement(block);
        });
      });
      this.registerEditorExtension(
        import_view2.ViewPlugin.fromClass(StructuredTextHighlight, {
          decorations: (plugin) => plugin.decorations
        })
      );
      this.app.workspace.updateOptions();
    } catch (error) {
      console.error("Failed to load Prism: ", error);
    }
  }
  onunload() {
    console.log("Unloading Structured Text Syntax Highlighter Plugin");
    if (this.obsidianPrism && this.obsidianPrism.languages.structuredtext) {
      delete this.obsidianPrism.languages.structuredtext;
    }
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJsb2FkUHJpc21XaXRoU1QudHMiLCAic3RydWN0dXJlZHRleHRIaWdobGlnaHRlci50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgUGx1Z2luIH0gZnJvbSAnb2JzaWRpYW4nO1xyXG5pbXBvcnQgbG9hZFByaXNtV2l0aFNUIGZyb20gJ2xvYWRQcmlzbVdpdGhTVCc7XHJcbmltcG9ydCBTdHJ1Y3R1cmVkVGV4dEhpZ2hsaWdodGVyIGZyb20gJ3N0cnVjdHVyZWR0ZXh0SGlnaGxpZ2h0ZXInO1xyXG5pbXBvcnQgeyBWaWV3UGx1Z2luIH0gZnJvbSAnQGNvZGVtaXJyb3Ivdmlldyc7XHJcblxyXG5jb25zb2xlLmxvZyhcIlN0cnVjdHVyZWRUZXh0IHBsdWdpbiBmaWxlIGxvYWRlZFwiKTtcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3RydWN0dXJlZFRleHRTeW50YXhIaWdobGlnaHRlclBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XHJcbiAgb2JzaWRpYW5QcmlzbTogYW55O1xyXG5cclxuICBhc3luYyBvbmxvYWQoKSB7XHJcbiAgICBjb25zb2xlLmxvZygnUmVhY2hlZCBvbmxvYWQnKTtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdMb2FkaW5nIFN0cnVjdHVyZWQgVGV4dCBIaWdobGlnaHRlciBQbHVnaW4nKTtcclxuICAgICAgdGhpcy5vYnNpZGlhblByaXNtID0gYXdhaXQgbG9hZFByaXNtV2l0aFNUKCk7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdwcmlzbSBsb2FkZWQnKTtcclxuXHJcbiAgICAgIHRoaXMucmVnaXN0ZXJNYXJrZG93blBvc3RQcm9jZXNzb3IoKGVsLCBjdHgpID0+IHtcclxuICAgICAgICBlbC5xdWVyeVNlbGVjdG9yQWxsKCdwcmUgPiBjb2RlLmxhbmd1YWdlLXN0cnVjdHVyZWR0ZXh0JykuZm9yRWFjaCgoYmxvY2spID0+IHtcclxuICAgICAgICAgIHRoaXMub2JzaWRpYW5QcmlzbS5oaWdobGlnaHRFbGVtZW50KGJsb2NrKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICB0aGlzLnJlZ2lzdGVyRWRpdG9yRXh0ZW5zaW9uKFxyXG4gICAgICAgIFZpZXdQbHVnaW4uZnJvbUNsYXNzKFN0cnVjdHVyZWRUZXh0SGlnaGxpZ2h0ZXIsIHtcclxuICAgICAgICAgIGRlY29yYXRpb25zOiAocGx1Z2luKSA9PiBwbHVnaW4uZGVjb3JhdGlvbnMsXHJcbiAgICAgICAgfSlcclxuICAgICAgKTtcclxuXHJcbiAgICAgIHRoaXMuYXBwLndvcmtzcGFjZS51cGRhdGVPcHRpb25zKCk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBQcmlzbTogJywgZXJyb3IpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgb251bmxvYWQoKSB7XHJcbiAgICBjb25zb2xlLmxvZygnVW5sb2FkaW5nIFN0cnVjdHVyZWQgVGV4dCBTeW50YXggSGlnaGxpZ2h0ZXIgUGx1Z2luJyk7XHJcblxyXG4gICAgaWYgKHRoaXMub2JzaWRpYW5QcmlzbSAmJiB0aGlzLm9ic2lkaWFuUHJpc20ubGFuZ3VhZ2VzLnN0cnVjdHVyZWR0ZXh0KSB7XHJcbiAgICAgIGRlbGV0ZSB0aGlzLm9ic2lkaWFuUHJpc20ubGFuZ3VhZ2VzLnN0cnVjdHVyZWR0ZXh0O1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCAiaW1wb3J0IHsgbG9hZFByaXNtIH0gZnJvbSBcIm9ic2lkaWFuXCI7XHJcblxyXG5cclxuXHJcbmNvbnN0IGFwcGx5UHJpc21TVCA9IChQcmlzbTogYW55KSA9PiB7XHJcblxyXG4gIGNvbnN0IGNvbnRyb2xLZXl3b3JkR3JvdXBzID0ge1xyXG5cclxuICAgIGlmU3RhdGVtZW50S2V5d29yZHM6IFsnSUYnLCAnRUxTSUYnLCAnRUxTRScsICdUSEVOJywgJ0VORF9JRiddLFxyXG4gICAgY2FzZVN0YXRlbWVudEtleXdvcmRzOiBbJ0NBU0UnLCAnT0YnLCAnRU5EX0NBU0UnXSxcclxuICAgIGZvclN0YXRlTWVudEtleXdvcmRzOiBbJ0ZPUicsICdUTycsICdCWScsICdETycsICdFTkRfRk9SJ10sXHJcbiAgICB3aGlsZVN0YXRlbWVudEtleXdvcmRzOiBbJ1dISUxFJywgJ0RPJywgJ0VORF9XSElMRSddLFxyXG4gICAgcmVwZWF0U3RhdG1lbnRLZXl3b3JkczogWydSRVBFQVQnLCAnVU5USUwnLCAnRU5EX1JFUEVBVCddLFxyXG4gICAgY29udGludWVLZXl3b3JkOiBbJ0NPTlRJTlVFJ10sXHJcbiAgICBleGl0U3RhdGVtZW50S2V5d29yZHM6IFsnRVhJVCddLFxyXG4gICAgcmV0dXJuU3RhdGVtZW50S2V5d29yZHM6IFsnUkVUVVJOJ11cclxuICB9O1xyXG5cclxuICBjb25zdCB0eXBlZEtleXdvcmRHcm91cHMgPSB7XHJcbiAgICBpbnRLZXl3b3JkczogWydVU0lOVCcsICdTSU5UJywgJ1VJTlQnLCAnSU5UJywgJ1VESU5UJywgJ0RJTlQnLCAnVUxJTlQnLCAnTElOVFQnXSxcclxuICAgIGZsb2F0S2V5d29yZHM6IFsnUkVBTCcsICdMUkVBTCddLFxyXG4gICAgYm9vbEtleXdvcmRzOiBbJ0JPT0wnXSxcclxuICAgIHN0cmluZ0tleXdvcmRzOiBbJ1NUUklORycsICdXU1RSSU5HJ10sXHJcbiAgICBiaW5LZXl3b3JkczogWydCWVRFJywgJ1dPUkQnLCAnRFdPUkQnLCAnTFdPUkQnXSxcclxuICAgIHRpbWVLZXl3b3JkczogWydUSU1FJywgJ0xUSU1FJ11cclxuICB9O1xyXG5cclxuICBjb25zdCBkZWNsYXJhdGlvbktleXdvcmRzID0ge1xyXG4gICAgdmFyaWFibGVzOiBbJ1ZBUicsICdWQVJfSU5QVVQnLCAnVkFSX09VVFBVVCcsICdWQVJfSU5fT1VUJywgJ1ZBUl9URU1QJywgJ1ZBUl9DT05TVEFOVCcsICdFTkRfVkFSJ10sXHJcbiAgICB0eXBlczogWydUWVBFJywgJ0VORF9UWVBFJywgJ1NUUlVDVCcsICdFTkRfU1RSVUNUJ10sXHJcbiAgICBmdW5jdGlvbnM6IFsnRlVOQ1RJT04nLCAnRU5EX0ZVTkNUSU9OJywgJ0ZVTkNUSU9OX0JMT0NLJywgJ0VORF9GVU5DVElPTl9CTE9DSyddXHJcbiAgfTtcclxuXHJcbiAgY29uc3QgYWxsS2V5d29yZHMgPSBbXHJcbiAgICAuLi5PYmplY3QudmFsdWVzKGNvbnRyb2xLZXl3b3JkR3JvdXBzKS5mbGF0KCksXHJcbiAgICAuLi5PYmplY3QudmFsdWVzKHR5cGVkS2V5d29yZEdyb3VwcykuZmxhdCgpLFxyXG4gICAgLi4uT2JqZWN0LnZhbHVlcyhkZWNsYXJhdGlvbktleXdvcmRzKS5mbGF0KClcclxuICBdO1xyXG5cclxuICBjb25zdCBrZXl3b3JkUmVnZXggPSBuZXcgUmVnRXhwKGBcXFxcYigke2FsbEtleXdvcmRzLmpvaW4oJ3wnKX0pXFxcXGJgKTtcclxuXHJcbiAgUHJpc20ubGFuZ3VhZ2VzLnN0cnVjdHVyZWR0ZXh0ID0gUHJpc20ubGFuZ3VhZ2VzLmV4dGVuZCgnY2xpa2UnLCB7XHJcblxyXG5cclxuICAgIGtleXdvcmQ6IGtleXdvcmRSZWdleCxcclxuICAgIGJvb2xlYW46IC9cXGIoVFJVRXxGQUxTRSlcXGIvLFxyXG4gICAgb3BlcmF0b3I6IC9cXGIoQU5EfE9SfE5PVHxYT1IpXFxifDo9fDw+fDw9fD49fDx8Pi8sXHJcbiAgICBudW1iZXI6IC9cXGJcXGQrKFxcLlxcZCspP1xcYi8sXHJcbiAgICBwdW5jdHVhdGlvbjogL1soKTssXS8sXHJcbiAgICBpZGVudGlmaWVyOiAvXFxiW0EtWmEtel9dW0EtWmEtejAtOV9dKlxcYi9cclxuICB9KTtcclxuXHJcbiAgUHJpc20uaG9va3MuYWRkKCd3cmFwJywgKGVudjoge1xyXG4gICAgdHlwZTogc3RyaW5nLCBhdHRyaWJ1dGVzOiB7IFt4OiBzdHJpbmddOiBhbnkgfTtcclxuICAgIGNvbnRlbnQ6IHN0cmluZ1xyXG4gIH0pID0+IHtcclxuICAgIGlmIChlbnYudHlwZSA9PT0gJ2VudGl0eScpIHtcclxuICAgICAgZW52LmF0dHJpYnV0ZXNbJ3RpdGxlJ10gPSBlbnYuY29udGVudC5yZXBsYWNlKC8mYW1wOy8sICcmJyk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG5cclxufTtcclxuXHJcbmNvbnN0IGxvYWRQcmlzbVdpdGhTVCA9IGFzeW5jICgpID0+IHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgUHJpc20gPSBhd2FpdCBsb2FkUHJpc20oKTtcclxuICAgIGFwcGx5UHJpc21TVChQcmlzbSk7XHJcbiAgICByZXR1cm4gUHJpc207XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJGYWlsZWQgdG8gbG9hZCBQcmlzbTpcIiwgZXJyb3IpO1xyXG4gICAgdGhyb3cgZXJyb3I7XHJcbiAgfVxyXG59O1xyXG5cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGxvYWRQcmlzbVdpdGhTVDtcclxuIiwgImltcG9ydCB7IERlY29yYXRpb24sIERlY29yYXRpb25TZXQsIEVkaXRvclZpZXcsIFBsdWdpblZhbHVlLCBWaWV3VXBkYXRlIH0gZnJvbSBcIkBjb2RlbWlycm9yL3ZpZXdcIjtcclxuaW1wb3J0IHsgUmFuZ2VTZXRCdWlsZGVyIH0gZnJvbSBcIkBjb2RlbWlycm9yL3N0YXRlXCI7XHJcbmltcG9ydCBsb2FkUHJpc21XaXRoU1QgZnJvbSBcImxvYWRQcmlzbVdpdGhTVFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU3RydWN0dXJlZFRleHRIaWdobGlnaHQgaW1wbGVtZW50cyBQbHVnaW5WYWx1ZSB7XHJcbiAgZGVjb3JhdGlvbnM6IERlY29yYXRpb25TZXQ7XHJcbiAgcHJpc206IGFueTtcclxuXHJcbiAgY29uc3RydWN0b3IodmlldzogRWRpdG9yVmlldykge1xyXG4gICAgdGhpcy5kZWNvcmF0aW9ucyA9IERlY29yYXRpb24ubm9uZTtcclxuICAgIHRoaXMubG9hZFByaXNtKCkudGhlbigoKSA9PiB7XHJcbiAgICAgIHRoaXMuZGVjb3JhdGlvbnMgPSB0aGlzLmJ1aWxkRGVjb3JhdGlvbnModmlldyk7XHJcbiAgICAgIHZpZXcudXBkYXRlKFtdKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlKHVwZGF0ZTogVmlld1VwZGF0ZSk6IHZvaWQge1xyXG4gICAgaWYgKHVwZGF0ZS52aWV3cG9ydENoYW5nZWQgfHwgdXBkYXRlLmRvY0NoYW5nZWQpIHtcclxuICAgICAgdGhpcy5kZWNvcmF0aW9ucyA9IHRoaXMuYnVpbGREZWNvcmF0aW9ucyh1cGRhdGUudmlldyk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBsb2FkUHJpc20oKSB7XHJcbiAgICB0aGlzLnByaXNtID0gYXdhaXQgbG9hZFByaXNtV2l0aFNUKCk7XHJcbiAgfVxyXG5cclxuICBidWlsZERlY29yYXRpb25zKHZpZXc6IEVkaXRvclZpZXcpOiBEZWNvcmF0aW9uU2V0IHtcclxuICAgIGNvbnN0IGJ1aWxkZXIgPSBuZXcgUmFuZ2VTZXRCdWlsZGVyPERlY29yYXRpb24+KCk7XHJcblxyXG4gICAgaWYgKCF0aGlzLnByaXNtKSB7XHJcbiAgICAgIHJldHVybiBEZWNvcmF0aW9uLm5vbmU7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdGV4dCA9IHZpZXcuc3RhdGUuZG9jLnRvU3RyaW5nKCk7XHJcbiAgICBjb25zdCByZWdleCA9IC9gYGBzdHJ1Y3R1cmVkdGV4dCg/OltcXHNcXFNdKj8pKFtcXHNcXFNdKj8pXFxuYGBgL2dpO1xyXG5cclxuICAgIGxldCBtYXRjaDtcclxuICAgIHdoaWxlICgobWF0Y2ggPSByZWdleC5leGVjKHRleHQpKSAhPT0gbnVsbCkge1xyXG4gICAgICBjb25zdCBjb2RlQmxvY2sgPSBtYXRjaFsxXTtcclxuICAgICAgY29uc3QgaGlnaGxpZ2h0ZWQgPSB0aGlzLnByaXNtLmhpZ2hsaWdodChjb2RlQmxvY2ssIHRoaXMucHJpc20ubGFuZ3VhZ2VzLnN0cnVjdHVyZWR0ZXh0LCBcInN0cnVjdHVyZWR0ZXh0XCIpO1xyXG5cclxuICAgICAgY29uc3QgYmxvY2tTdGFydCA9IG1hdGNoLmluZGV4ICsgbWF0Y2hbMF0uaW5kZXhPZihtYXRjaFsxXSk7XHJcbiAgICAgIHRoaXMuYXBwbHlIaWdobGlnaHRpbmcoaGlnaGxpZ2h0ZWQsIGJsb2NrU3RhcnQsIGJ1aWxkZXIpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBidWlsZGVyLmZpbmlzaCgpO1xyXG4gIH1cclxuXHJcbiAgYXBwbHlIaWdobGlnaHRpbmcoaGlnaGxpZ2h0ZWQ6IHN0cmluZywgYmxvY2tTdGFydDogbnVtYmVyLCBidWlsZGVyOiBSYW5nZVNldEJ1aWxkZXI8RGVjb3JhdGlvbj4pIHtcclxuICAgIGNvbnN0IHBhcnNlciA9IG5ldyBET01QYXJzZXIoKTtcclxuICAgIGNvbnN0IGRvYyA9IHBhcnNlci5wYXJzZUZyb21TdHJpbmcoaGlnaGxpZ2h0ZWQsIFwidGV4dC9odG1sXCIpO1xyXG4gICAgY29uc3QgdGVtcEVsID0gZG9jLmJvZHk7XHJcblxyXG4gICAgbGV0IGN1cnJlbnRJbmRleCA9IGJsb2NrU3RhcnQ7XHJcbiAgICBjb25zdCByYW5nZXM6IHsgc3RhcnQ6IG51bWJlcjsgZW5kOiBudW1iZXI7IGNsYXNzTmFtZTogc3RyaW5nIH1bXSA9IFtdO1xyXG5cclxuICAgIGNvbnN0IHRyYXZlcnNlID0gKG5vZGU6IE5vZGUpID0+IHtcclxuICAgICAgaWYgKG5vZGUubm9kZVR5cGUgPT09IE5vZGUuVEVYVF9OT0RFKSB7XHJcbiAgICAgICAgY29uc3QgdGV4dCA9IG5vZGUudGV4dENvbnRlbnQgfHwgXCJcIjtcclxuICAgICAgICBjdXJyZW50SW5kZXggKz0gdGV4dC5sZW5ndGg7XHJcbiAgICAgIH0gZWxzZSBpZiAobm9kZS5ub2RlVHlwZSA9PT0gTm9kZS5FTEVNRU5UX05PREUpIHtcclxuICAgICAgICBjb25zdCBlbGVtZW50ID0gbm9kZSBhcyBIVE1MRWxlbWVudDtcclxuICAgICAgICBjb25zdCBjbGFzc05hbWUgPSBlbGVtZW50LmNsYXNzTmFtZTtcclxuXHJcbiAgICAgICAgY29uc3Qgc3RhcnQgPSBjdXJyZW50SW5kZXg7XHJcbiAgICAgICAgZWxlbWVudC5jaGlsZE5vZGVzLmZvckVhY2goKGNoaWxkKSA9PiB0cmF2ZXJzZShjaGlsZCkpO1xyXG4gICAgICAgIGNvbnN0IGVuZCA9IGN1cnJlbnRJbmRleDtcclxuXHJcbiAgICAgICAgaWYgKGNsYXNzTmFtZSkge1xyXG4gICAgICAgICAgcmFuZ2VzLnB1c2goeyBzdGFydCwgZW5kLCBjbGFzc05hbWUgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHRlbXBFbC5jaGlsZE5vZGVzLmZvckVhY2goKGNoaWxkKSA9PiB0cmF2ZXJzZShjaGlsZCkpO1xyXG5cclxuICAgIHJhbmdlcy5zb3J0KChhLCBiKSA9PiBhLnN0YXJ0IC0gYi5zdGFydCk7XHJcblxyXG4gICAgZm9yIChjb25zdCByYW5nZSBvZiByYW5nZXMpIHtcclxuICAgICAgYnVpbGRlci5hZGQocmFuZ2Uuc3RhcnQsIHJhbmdlLmVuZCwgRGVjb3JhdGlvbi5tYXJrKHsgY2xhc3M6IHJhbmdlLmNsYXNzTmFtZSB9KSk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG4iXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUEsbUJBQXVCOzs7QUNBdkIsc0JBQTBCO0FBSTFCLElBQU0sZUFBZSxDQUFDLFVBQWU7QUFFbkMsUUFBTSx1QkFBdUI7QUFBQSxJQUUzQixxQkFBcUIsQ0FBQyxNQUFNLFNBQVMsUUFBUSxRQUFRLFFBQVE7QUFBQSxJQUM3RCx1QkFBdUIsQ0FBQyxRQUFRLE1BQU0sVUFBVTtBQUFBLElBQ2hELHNCQUFzQixDQUFDLE9BQU8sTUFBTSxNQUFNLE1BQU0sU0FBUztBQUFBLElBQ3pELHdCQUF3QixDQUFDLFNBQVMsTUFBTSxXQUFXO0FBQUEsSUFDbkQsd0JBQXdCLENBQUMsVUFBVSxTQUFTLFlBQVk7QUFBQSxJQUN4RCxpQkFBaUIsQ0FB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
